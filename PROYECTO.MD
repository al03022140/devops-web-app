# Dashboard de Avisos Semanales - Sistema de GestiÃ³n

## ğŸ“‹ DescripciÃ³n del Proyecto

**Sistema web de dashboard** para gestiÃ³n de avisos semanales donde los administradores pueden publicar actividades y tareas de la semana, y los usuarios pueden visualizar y comentar en tiempo real.

### ğŸ¯ Objetivo Principal
Crear una plataforma simple y funcional que permita la comunicaciÃ³n efectiva del equipo mediante avisos semanales con sistema de comentarios integrado.

---

## ğŸ—ï¸ Arquitectura del Sistema

### **Stack TecnolÃ³gico**
- **Backend**: Node.js + Express
- **Base de Datos**: MySQL
- **Frontend**: HTML5 + CSS3 + JavaScript vanilla
- **AutenticaciÃ³n**: JWT
- **DevOps**: Docker + GitHub Actions
- **Monitoreo**: Prometheus + Grafana

### **Estructura de Carpetas**
```
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/       # GitHub Actions CI/CD
â”‚       â”œâ”€â”€ ci.yml       # Pipeline de integraciÃ³n continua
â”‚       â””â”€â”€ deploy.yml   # Pipeline de despliegue
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ models/          # Modelos de BD (Usuario, Aviso, Comentario)
â”‚   â”œâ”€â”€ routes/          # Rutas API (auth, avisos, comentarios)
â”‚   â”œâ”€â”€ middlewares/     # AutenticaciÃ³n y permisos
â”‚   â””â”€â”€ lib/             # ConexiÃ³n BD y utilidades
â”œâ”€â”€ Front/
â”‚   â”œâ”€â”€ html/            # PÃ¡ginas del dashboard
â”‚   â””â”€â”€ css/             # Estilos del sistema
â”œâ”€â”€ terraform/
â”‚   â”œâ”€â”€ main.tf          # ConfiguraciÃ³n principal de infraestructura
â”‚   â”œâ”€â”€ variables.tf     # Variables de Terraform
â”‚   â”œâ”€â”€ outputs.tf       # Outputs de infraestructura
â”‚   â”œâ”€â”€ scripts/         # Scripts de inicializaciÃ³n
â”‚   â””â”€â”€ templates/       # Plantillas de configuraciÃ³n
â”œâ”€â”€ monitoring/
â”‚   â”œâ”€â”€ prometheus.yml   # ConfiguraciÃ³n de Prometheus
â”‚   â””â”€â”€ grafana/         # Dashboards y datasources de Grafana
â”œâ”€â”€ nginx/
â”‚   â””â”€â”€ nginx.conf       # ConfiguraciÃ³n del proxy reverso
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ setup.js         # ConfiguraciÃ³n de tests
â”‚   â””â”€â”€ api.test.js      # Tests de API
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ deploy-local.ps1 # Script de despliegue local
â”œâ”€â”€ docker-compose.yml       # ConfiguraciÃ³n desarrollo
â”œâ”€â”€ docker-compose.prod.yml  # ConfiguraciÃ³n producciÃ³n
â”œâ”€â”€ jest.config.js           # ConfiguraciÃ³n de testing
â”œâ”€â”€ DEPLOYMENT.md            # DocumentaciÃ³n de despliegue
â””â”€â”€ .env.prod.example        # Variables de entorno ejemplo
```

---

## ğŸ—„ï¸ Estructura de Base de Datos

### **Tabla: usuarios**
```sql
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- nombre (VARCHAR(100), NOT NULL)
- email (VARCHAR(150), UNIQUE, NOT NULL)
- contraseÃ±a (VARCHAR(255), NOT NULL) -- Hash bcrypt
- tipo_usuario (ENUM('administrador', 'editor', 'visualizador'), DEFAULT 'visualizador')
- fecha_creacion (TIMESTAMP, DEFAULT CURRENT_TIMESTAMP)
- activo (BOOLEAN, DEFAULT TRUE)
```

### **Tabla: avisos**
```sql
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- titulo (VARCHAR(200), NOT NULL)
- descripcion (TEXT, NOT NULL)
- fecha_inicio_semana (DATE, NOT NULL)
- fecha_fin_semana (DATE, NOT NULL)
- creado_por (INT, FOREIGN KEY â†’ usuarios.id)
- fecha_creacion (TIMESTAMP, DEFAULT CURRENT_TIMESTAMP)
- activo (BOOLEAN, DEFAULT TRUE)
```

### **Tabla: comentarios**
```sql
- id (INT, PRIMARY KEY, AUTO_INCREMENT)
- aviso_id (INT, FOREIGN KEY â†’ avisos.id)
- usuario_id (INT, FOREIGN KEY â†’ usuarios.id)
- comentario (TEXT, NOT NULL)
- fecha_comentario (TIMESTAMP, DEFAULT CURRENT_TIMESTAMP)
```

---

## ğŸ¨ Interfaz del Dashboard

### **PÃ¡ginas Principales**

#### **1. Login** (`login.html`)
- AutenticaciÃ³n con email/contraseÃ±a
- ValidaciÃ³n en tiempo real
- RedirecciÃ³n automÃ¡tica post-login

#### **2. Dashboard Principal** (`dashboard.html`)
- Vista general de avisos activos
- MÃ©tricas de actividad
- Acceso rÃ¡pido a funciones principales

#### **3. GestiÃ³n de Avisos** (`avisos-management.html`)
- CRUD completo de avisos
- Editor de texto enriquecido
- PrevisualizaciÃ³n en tiempo real

#### **4. Historial de Avisos** (`avisos-history.html`)
- BÃºsqueda y filtrado avanzado
- PaginaciÃ³n optimizada
- ExportaciÃ³n de datos

#### **5. Detalle de Aviso** (`aviso-detail.html`)
- Vista completa del aviso
- Sistema de comentarios en tiempo real
- ModeraciÃ³n de comentarios

#### **6. GestiÃ³n de Usuarios** (`users-list.html`, `user-detail.html`)
- Lista de usuarios con filtros
- EdiciÃ³n de perfiles y permisos
- Actividad de usuarios

#### **7. ModeraciÃ³n** (`comentarios-moderacion.html`)
- RevisiÃ³n de comentarios
- Acciones de moderaciÃ³n
- Historial de moderaciÃ³n

#### **8. Actividad de Usuarios** (`actividad-usuarios.html`)
- Logs de actividad
- MÃ©tricas de engagement
- Reportes de uso

---

## ğŸ”§ DevOps y AutomatizaciÃ³n

### **Pipeline CI/CD Implementado**

#### **1. IntegraciÃ³n Continua (CI)**
- **GitHub Actions** (`.github/workflows/ci.yml`)
  - âœ… Tests automatizados con Jest + Supertest
  - âœ… Build de imagen Docker
  - âœ… Push a GitHub Container Registry (GHCR)
  - âœ… Escaneo de seguridad con Trivy
  - âœ… ValidaciÃ³n de cÃ³digo con ESLint

#### **2. Infraestructura como CÃ³digo (IaC)**
- **Terraform** (`terraform/`)
  - âœ… Provisioning automÃ¡tico en proveedor de nube
  - âœ… VPC, servidor, firewall configurados
  - âœ… Load Balancer opcional
  - âœ… Scripts de inicializaciÃ³n (cloud-init)
  - âœ… Variables y outputs configurables

#### **3. Despliegue Continuo (CD)**
- **GitHub Actions** (`.github/workflows/deploy.yml`)
  - âœ… Deploy automÃ¡tico tras CI exitoso
  - âœ… Provisioning de infraestructura
  - âœ… Despliegue de aplicaciÃ³n
  - âœ… VerificaciÃ³n de salud
  - âœ… Rollback automÃ¡tico en fallos

#### **4. ContenedorizaciÃ³n**
- **Docker Compose ProducciÃ³n** (`docker-compose.prod.yml`)
  - âœ… AplicaciÃ³n Node.js
  - âœ… Base de datos MySQL 8.0
  - âœ… Prometheus para mÃ©tricas
  - âœ… Grafana para visualizaciÃ³n
  - âœ… Nginx como proxy reverso
  - âœ… Health checks configurados

### **Stack de Monitoreo Implementado**

#### **Prometheus** (`monitoring/prometheus.yml`)
- âœ… MÃ©tricas de aplicaciÃ³n (`/metrics`)
- âœ… MÃ©tricas de sistema (Node Exporter)
- âœ… MÃ©tricas de MySQL
- âœ… MÃ©tricas de Docker
- âœ… ConfiguraciÃ³n de alertas

#### **Grafana** (`monitoring/grafana/`)
- âœ… Dashboards preconfigurados
- âœ… Datasource Prometheus automÃ¡tico
- âœ… VisualizaciÃ³n en tiempo real
- âœ… Alertas configurables

#### **Nginx** (`nginx/nginx.conf`)
- âœ… Proxy reverso con load balancing
- âœ… Rate limiting en endpoints crÃ­ticos
- âœ… Headers de seguridad
- âœ… CompresiÃ³n gzip
- âœ… Logs estructurados

### **Ambientes y ConfiguraciÃ³n**

#### **Desarrollo Local**
- **Docker Compose** (`docker-compose.yml`)
- **Script PowerShell** (`scripts/deploy-local.ps1`)
  - Build automÃ¡tico
  - Inicio/parada de servicios
  - VisualizaciÃ³n de logs
  - Limpieza de entorno

#### **ProducciÃ³n**
- **Servidor VPS** (2 vCPU, 2GB RAM)
- **Terraform gestionado**
- **Docker Compose en producciÃ³n**
- **Monitoreo 24/7**

### **ConfiguraciÃ³n de Secretos**

#### **GitHub Secrets Requeridos**
```
CLOUD_API_TOKEN=tu_token_de_api_del_proveedor
SSH_PUBLIC_KEY=ssh-rsa AAAAB3NzaC1yc2E...
ALLOWED_SSH_IP=tu.ip.publica.aqui
DB_PASSWORD=tu_password_mysql_seguro
JWT_SECRET=tu_jwt_secret_super_seguro
```

#### **Variables de Entorno** (`.env.prod`)
```bash
# AplicaciÃ³n
NODE_ENV=production
PORT=3000

# Base de Datos
MYSQL_ROOT_PASSWORD=password_seguro_mysql
MYSQL_DATABASE=devops_app

# JWT
JWT_SECRET=clave_jwt_super_segura

# Monitoreo
METRICS_ENABLED=true
GF_SECURITY_ADMIN_PASSWORD=admin_grafana_password

# GitHub Container Registry
GITHUB_REPOSITORY=tu-usuario/tu-repo
```

---

## ğŸ”’ Seguridad Implementada

### **AutenticaciÃ³n y AutorizaciÃ³n**
- JWT con expiraciÃ³n configurable
- Middleware de autenticaciÃ³n en todas las rutas protegidas
- Roles de usuario (admin, editor, visualizador)
- ValidaciÃ³n de permisos por endpoint

### **Seguridad de API**
- ValidaciÃ³n de entrada con express-validator
- SanitizaciÃ³n de datos
- Rate limiting por IP
- CORS configurado
- Headers de seguridad (Helmet.js)

### **Base de Datos**
- ContraseÃ±as hasheadas con bcrypt
- Prepared statements (prevenciÃ³n SQL injection)
- Conexiones SSL en producciÃ³n
- Backup automÃ¡tico configurado

### **Infraestructura**
- Firewall configurado (SSH, HTTP, HTTPS)
- Acceso SSH restringido por IP
- VPC privada
- Certificados SSL/TLS

### **Docker y Contenedores**
- Contenedores sin privilegios
- Redes aisladas
- Health checks obligatorios
- ImÃ¡genes escaneadas por vulnerabilidades

### **Nginx**
- Rate limiting (10 req/s general, 5 req/m auth)
- Headers de seguridad (XSS, CSRF, etc.)
- RestricciÃ³n de acceso a mÃ©tricas
- Logs de seguridad

#### **Docker**
- Contenedores sin privilegios
- Redes aisladas
- Health checks obligatorios
- ImÃ¡genes escaneadas por vulnerabilidades

#### **Terraform**
- Firewall configurado (SSH, HTTP, HTTPS)
- Acceso SSH restringido por IP
- VPC privada
- Backup automÃ¡tico opcional

### **Costos Estimados (Mensual)**
- **Servidor VPS** (2 vCPU, 2GB RAM): $20-30
- **Load Balancer** (opcional): $10-15
- **Almacenamiento adicional** (50GB): $5-10
- **Total estimado**: $25-55/mes

### **Escalabilidad**
- **Horizontal**: MÃºltiples servidores + Load Balancer
- **Vertical**: Upgrade de especificaciones del servidor
- **Base de datos**: MySQL Cluster o servicio gestionado
- **CDN**: Cloudflare para contenido estÃ¡tico

---

## ğŸ“± CaracterÃ­sticas de UX/UI

### **DiseÃ±o Responsive**
- Adaptable a mÃ³viles y escritorio
- Tema oscuro por defecto
- IconografÃ­a intuitiva con emojis

### **Funcionalidades de Usuario**
- Notificaciones en tiempo real
- BÃºsqueda de avisos
- Filtros avanzados
- ExportaciÃ³n de datos
- Modo offline bÃ¡sico

### **Experiencia de Administrador**
- Dashboard de mÃ©tricas
- GestiÃ³n de usuarios
- ModeraciÃ³n de contenido
- ConfiguraciÃ³n del sistema
- Logs de auditorÃ­a

---

## ğŸš€ InstalaciÃ³n y Despliegue

### **Desarrollo Local**

#### **Prerrequisitos**
- Docker y Docker Compose
- Node.js 18+ (para desarrollo)
- Git

#### **Pasos de InstalaciÃ³n**
```bash
# 1. Clonar repositorio
git clone <tu-repo>
cd devops-dashboard

# 2. Configurar variables de entorno
cp .env.example .env
# Editar .env con tus valores

# 3. Ejecutar con Docker Compose
docker-compose up -d --build

# 4. Verificar servicios
curl http://localhost:3000/health
```

#### **Script PowerShell** (Windows)
```powershell
# Build y start
.\scripts\deploy-local.ps1 -Build
.\scripts\deploy-local.ps1 -Start

# All-in-one (build + start + tunnel)
.\scripts\deploy-local.ps1 -AllInOne

# Con override local
.\scripts\deploy-local.ps1 -AllInOne -LocalOverride

# Ver logs
.\scripts\deploy-local.ps1 -Logs

# Limpiar
.\scripts\deploy-local.ps1 -Clean
```

### **ProducciÃ³n**

#### **OpciÃ³n 1: Terraform (Recomendado)**
```bash
# 1. Configurar variables
cd terraform
cp terraform.tfvars.example terraform.tfvars
# Editar terraform.tfvars

# 2. Desplegar infraestructura
terraform init
terraform plan
terraform apply

# 3. Verificar despliegue
curl http://<server-ip>:3000/health
```

#### **OpciÃ³n 2: Servidor Existente**
```bash
# 1. Conectar al servidor
ssh user@tu-servidor

# 2. Instalar Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# 3. Clonar y configurar
git clone <tu-repo>
cd devops-dashboard
cp .env.prod.example .env.prod
# Editar .env.prod

# 4. Desplegar
docker-compose -f docker-compose.prod.yml up -d --build
```

---

## ğŸ“Š Monitoreo y MÃ©tricas

### **URLs de Acceso**
- **AplicaciÃ³n**: http://localhost:3000
- **Grafana**: http://localhost:3001 (admin/admin)
- **Prometheus**: http://localhost:9090
- **MÃ©tricas API**: http://localhost:3000/metrics

### **MÃ©tricas Disponibles**
- Requests por segundo
- Tiempo de respuesta promedio
- Errores HTTP por cÃ³digo
- Usuarios activos
- Avisos creados/dÃ­a
- Comentarios por aviso
- Uso de CPU/Memoria
- Conexiones de BD activas

### **Alertas Configuradas**
- CPU > 80% por 5 minutos
- Memoria > 90% por 3 minutos
- Tiempo de respuesta > 2s
- Tasa de error > 5%
- BD desconectada
- Disco > 85%

---

## ğŸ§ª Testing

### **Tipos de Tests**
- **Unitarios**: Modelos y utilidades
- **IntegraciÃ³n**: APIs y BD
- **E2E**: Flujos completos de usuario
- **Carga**: Performance con k6

### **Comandos de Testing**
```bash
# Tests unitarios e integraciÃ³n
npm test

# Tests con coverage
npm run test:coverage

# Tests E2E
npm run test:e2e

# Tests de carga
npm run test:load
```

### **Coverage Objetivo**
- **LÃ­neas**: >90%
- **Funciones**: >95%
- **Branches**: >85%
- **Statements**: >90%

---

## ğŸ“š API Documentation

### **Endpoints Principales**

#### **AutenticaciÃ³n**
```
POST /api/auth/login
POST /api/auth/register
POST /api/auth/logout
GET  /api/auth/me
```

#### **Avisos**
```
GET    /api/avisos           # Listar avisos
POST   /api/avisos           # Crear aviso
GET    /api/avisos/:id       # Obtener aviso
PUT    /api/avisos/:id       # Actualizar aviso
DELETE /api/avisos/:id       # Eliminar aviso
```

#### **Comentarios**
```
GET    /api/comentarios/:avisoId    # Listar comentarios
POST   /api/comentarios/:avisoId    # Crear comentario
PUT    /api/comentarios/:id         # Actualizar comentario
DELETE /api/comentarios/:id         # Eliminar comentario
```

#### **Usuarios**
```
GET    /api/users           # Listar usuarios (admin)
GET    /api/users/:id       # Obtener usuario
PUT    /api/users/:id       # Actualizar usuario
DELETE /api/users/:id       # Eliminar usuario
```

#### **MÃ©tricas**
```
GET /api/metricas/dashboard    # MÃ©tricas del dashboard
GET /api/metricas/usuarios     # Actividad de usuarios
GET /metrics                   # MÃ©tricas Prometheus
```

---

## ğŸ”„ Flujo de Desarrollo

### **Git Workflow**
```bash
# 1. Feature branch
git checkout -b feature/nueva-funcionalidad

# 2. Desarrollo y commits
git add .
git commit -m "feat: nueva funcionalidad"

# 3. Push y PR
git push origin feature/nueva-funcionalidad
# Crear Pull Request en GitHub

# 4. CI automÃ¡tico
# - Tests
# - Build Docker
# - Security scan

# 5. Review y merge
# 6. Deploy automÃ¡tico a producciÃ³n
```

### **Convenciones de Commits**
- `feat:` Nueva funcionalidad
- `fix:` CorrecciÃ³n de bug
- `docs:` DocumentaciÃ³n
- `style:` Formato de cÃ³digo
- `refactor:` RefactorizaciÃ³n
- `test:` Tests
- `chore:` Tareas de mantenimiento

---

## ğŸ¯ Roadmap y Mejoras Futuras

### **Fase 2 - Funcionalidades Avanzadas**
- [ ] Notificaciones push
- [ ] Sistema de archivos adjuntos
- [ ] Editor WYSIWYG avanzado
- [ ] Plantillas de avisos
- [ ] Calendario integrado
- [ ] ExportaciÃ³n a PDF

### **Fase 3 - Escalabilidad**
- [ ] Microservicios
- [ ] Cache con Redis
- [ ] CDN para assets
- [ ] Base de datos distribuida
- [ ] Auto-scaling
- [ ] Multi-regiÃ³n

### **Fase 4 - Integraciones**
- [ ] API REST completa
- [ ] Webhooks
- [ ] IntegraciÃ³n Slack/Teams
- [ ] SSO (SAML/OAuth)
- [ ] Mobile app
- [ ] Desktop app (Electron)

---

## ğŸ“ Soporte y ContribuciÃ³n

### **Reportar Issues**
- Usar GitHub Issues
- Incluir logs y pasos para reproducir
- Especificar versiÃ³n y entorno

### **Contribuir**
1. Fork del repositorio
2. Crear feature branch
3. Seguir convenciones de cÃ³digo
4. Agregar tests
5. Crear Pull Request

### **Contacto**
- **DocumentaciÃ³n**: Ver `DEPLOYMENT.md`
- **Issues**: GitHub Issues
- **Discusiones**: GitHub Discussions

---

## ğŸ“„ Licencia

Este proyecto estÃ¡ bajo la licencia MIT. Ver `LICENSE` para mÃ¡s detalles.

---

**Ãšltima actualizaciÃ³n**: Diciembre 2024  
**VersiÃ³n**: 1.0.0  
**Estado**: ProducciÃ³n Ready âœ…